import matplotlib.pyplot as plt
import numpy as np

from model.linreg import linreg
from utils.util import extend_inputs_with_bias, sse, ensure_dir


def plot(data):
    targets, features = data[:, 0], data[:, 1:]
    markersizes = targets - min(targets) + 5
    markersizes = markersizes / max(markersizes)
    markersizes = markersizes * 300

    folder = "./imgs/autompg/"
    ensure_dir(folder)

    n = len(features[0])
    for i in range(n - 1):
        for j in range(i + 1, n):
            name = f"autompg_{i}_{j}"
            plt.title(name)
            plt.scatter(features[:, i], features[:, j], marker='o', c=[markersizes], s=markersizes, alpha=0.3,
                        label=name)
            plt.savefig(f"{folder}/{name}.png")
            plt.show()

    for i in range(n):
        name = f"autompg_feature_{i}"
        plt.title(name)
        plt.scatter(features[:, i], targets, marker='o', c=[markersizes], s=markersizes, alpha=0.3, label=name)
        plt.savefig(f"{folder}/{name}.png")
        plt.show()


def demo(seed=72):
    np.random.seed(seed)

    autompg_location = "./datasets/auto-mpg.data"
    with open(autompg_location, "r") as autompg:
        lines = [line for line in autompg.readlines() if '?' not in line]
        data = np.genfromtxt(lines, usecols=range(8))
        # plot(data)
        np.random.shuffle(data)

        split = 0.7
        train = data[:int(len(data) * split)]
        test = data[int(len(data) * split):]

        train = (train[:, 1:], train[:, 0])
        test = (test[:, 1:], test[:, 0])

    do_linreg(test, train)
    do_linreg_with_dataprep(test, train)
    print()


def do_linreg(train, test):
    beta = linreg(train[0], train[1])

    # print("TRAIN")
    outputs = np.dot(extend_inputs_with_bias(train[0]), beta)
    # print(list(zip(outputs, train[1])))
    sse(outputs, train[1])

    # print("TEST")
    outputs = np.dot(extend_inputs_with_bias(test[0]), beta)
    # print(list(zip(outputs, test[1])))
    sse(outputs, test[1])
    # print()


def autompg_feature_selection_1(x):
    # idx: 0 is cylinders, 6 is origin
    result = x

    # throw out feature 4 and 6
    result = result[:, [i for i in range(7) if i != 4 and i != 6]]
    # add square terms of features 1,2,3
    result = np.concatenate((result, result[:, 1:4] ** 2), axis=1)

    return result


def autompg_feature_selection_2(x):
    return np.concatenate((x, x[:, 1:4] ** 2), axis=1)


def do_linreg_with_dataprep(train, test):
    # NOTE: STANDARDIZATION IS USELESS FOR LINEAR REGRESSION :D
    # mean = train[0].mean(axis=0)
    # std = train[0].std(axis=0)
    # train = standardize(train[0], mean, std), train[1]
    # test = standardize(test[0], mean, std), test[1]

    do_linreg((autompg_feature_selection_1(train[0]), train[1]), (autompg_feature_selection_1(test[0]), test[1]))
    # do_linreg((autompg_feature_selection_2(train[0]), train[1]), (autompg_feature_selection_2(test[0]), test[1]))


if __name__ == '__main__':
    for i in range(10):
        demo(i)

"""
AUTO-MPG dataset (miles per gallon)

Number of Instances: 398
Number of Attributes: 9 including the class attribute
Missing Attribute Values:  horsepower has 6 missing values
Attribute Information:
    1. mpg:           continuous
    2. cylinders:     multi-valued discrete
    3. displacement:  continuous
    4. horsepower:    continuous
    5. weight:        continuous
    6. acceleration:  continuous
    7. model year:    multi-valued discrete
    8. origin:        multi-valued discrete
    9. car name:      string (unique for each instance)
    
    
TRAIN
[(21.92237679844455, 21.0), (23.963764021150567, 22.0), (29.380476822259414, 31.0), (30.580803353702365, 23.7), (23.503134357283578, 20.0), (24.29161196256525, 28.0), (35.018687274135964, 44.6), (29.432708080554235, 35.0), (34.66055264449073, 36.0), (24.352821104529003, 23.0), (25.991826105946394, 30.7), (10.645581405313234, 12.0), (31.59638659775201, 32.0), (24.418529912341302, 25.0), (26.052325699822706, 24.0), (12.793810692186625, 13.0), (26.71999214300781, 20.0), (10.669265774318092, 12.0), (21.604380941602226, 19.9), (25.297237589451058, 27.0), (22.509925334945194, 21.0), (26.763746162884306, 26.0), (24.022035756979477, 22.4), (31.26085608100382, 37.0), (24.345125410077436, 19.0), (19.90771522771507, 18.0), (32.07708030610026, 30.0), (22.943229076882226, 22.5), (15.451890105488701, 14.5), (20.704792199173127, 19.0), (19.760757263850053, 17.0), (28.542269042020298, 27.0), (13.65643944659104, 14.0), (16.293016604698607, 16.0), (24.308792953079003, 21.0), (31.304217443768025, 43.4), (16.59121390965904, 13.0), (33.599918208739645, 33.7), (23.95026678970405, 20.8), (29.60713954374427, 32.0), (17.390834635356715, 18.0), (21.47187537261701, 19.0), (13.381610933056798, 13.0), (10.099354019265366, 13.0), (32.39839954695347, 36.0), (23.52065759845827, 23.0), (19.9842390921441, 18.2), (22.689376276251885, 17.5), (19.162097326641735, 18.0), (26.361657246988873, 28.8), (20.475670560850165, 21.0), (29.114717302667415, 27.0), (13.676105342893, 16.5), (7.061559442573737, 10.0), (25.580249851231255, 25.0), (11.819360843613733, 14.0), (25.416767774882597, 23.8), (25.226539983737975, 19.0), (34.33772693412574, 34.0), (15.369547886750532, 15.0), (34.615817281775726, 32.3), (22.102440393212913, 20.6), (32.85963045342426, 32.8), (14.953687731339409, 16.0), (25.92598024853919, 25.1), (28.304763253667556, 25.4), (19.584568484275106, 16.0), (16.048957375422425, 15.5), (28.67999438875531, 38.0), (22.833113382255792, 24.0), (18.127066221715147, 19.0), (22.92356356595109, 17.0), (17.8218072802853, 13.0), (21.34838390583266, 19.0), (19.046039262308135, 15.5), (28.489473515898535, 31.0), (22.76404659714961, 20.6), (13.964073559701383, 15.0), (31.243304831386574, 31.6), (22.24973106051013, 24.0), (10.611551855936545, 14.0), (26.2220531054263, 20.2), (32.78962087606436, 33.0), (27.87911163350137, 33.5), (26.275474614062684, 24.0), (26.856636220608223, 36.4), (11.240343615169486, 13.0), (12.699632805132294, 14.0), (27.003445203388992, 26.0), (15.543240346492762, 16.0), (15.286592318225312, 18.0), (31.905223213258264, 31.0), (28.645899951546433, 30.9), (10.626429721678022, 15.0), (16.05232615820762, 11.0), (30.091014018333205, 29.0), (19.143653106454106, 22.0), (19.754309025413704, 16.5), (27.384871374851933, 24.0), (25.915869675942737, 24.3), (30.194372867156222, 29.9), (25.385852618845004, 20.3), (27.935058980304714, 24.0), (25.863691326549542, 22.0), (29.153560863296963, 29.0), (32.03738850011933, 33.0), (23.204142192074542, 20.5), (21.83963904806218, 19.0), (26.092358359418334, 22.0), (28.955121404593495, 27.0), (32.777066667542556, 32.4), (20.96002961262223, 23.0), (23.63655649437002, 20.0), (12.340458377076, 16.0), (25.688736611929627, 26.0), (15.201377889380424, 15.0), (28.452245559344195, 29.0), (26.86600914134018, 24.0), (12.64543592493917, 13.0), (22.663223165085228, 23.9), (29.106886135754383, 26.6), (12.775374554672052, 14.0), (22.513095871520704, 25.0), (17.553758071194615, 17.5), (11.696556604542408, 13.0), (29.725734524536293, 31.0), (19.67412517119265, 19.4), (29.838818978723243, 29.8), (33.34431139959944, 33.8), (23.62604362325209, 19.4), (22.1187132265232, 18.1), (26.78023382072415, 25.0), (14.8165428492802, 13.0), (25.29566961132694, 24.5), (34.932713707593344, 34.1), (8.868275922714776, 12.0), (25.188955161409822, 28.0), (34.51382363952689, 38.1), (10.486341257093759, 13.0), (30.222207927658086, 29.0), (30.053986039551745, 26.0), (21.142034464132312, 22.0), (24.372426254032742, 23.0), (19.167911329033572, 18.5), (20.51794097088396, 23.0), (17.54738391042902, 18.0), (28.651725278251064, 26.0), (25.65932793052024, 21.6), (10.53417215469714, 14.0), (35.833175574618686, 32.0), (34.236094088223574, 44.0), (34.603554980208976, 36.0), (15.075721225760287, 17.0), (21.041645795634977, 21.0), (34.64349461196375, 37.7), (21.527608393804634, 22.0), (13.405445479852169, 15.0), (30.892304284423435, 29.5), (7.776406775898684, 11.0), (32.25100023804128, 34.4), (26.04311263570141, 30.0), (24.609618559612084, 20.2), (31.230429081157645, 31.5), (14.896386010037237, 15.0), (10.18816394990921, 13.0), (28.74831041162683, 31.0), (31.185350648357325, 35.7), (33.1301642936547, 39.0), (11.365692618092694, 14.0), (27.122537114508347, 26.0), (27.512110408398424, 25.0), (14.74384439435451, 17.5), (28.62633135587432, 25.0), (29.732866608599984, 35.0), (27.074311196762807, 32.7), (31.15619789889123, 37.3), (35.49026944853147, 37.0), (21.743869091105964, 19.0), (23.02339837206853, 20.0), (26.183895302391473, 26.0), (25.747676999084096, 23.2), (11.715173250630922, 14.0), (6.844234646062496, 12.0), (26.367965581029427, 21.5), (28.50577310249263, 22.0), (18.746915796362146, 14.0), (13.131680870783576, 15.0), (10.537477849757726, 14.0), (28.053906029799165, 31.0), (30.401372829731624, 32.0), (17.2899715156941, 16.5), (24.175538968438197, 17.6), (19.759625892791632, 18.5), (31.147280643117767, 36.0), (32.383820032075285, 31.9), (29.676615005404535, 34.2), (31.048636563807662, 31.3), (34.07410868108716, 36.1), (20.2010800055177, 17.7), (20.578100751856095, 19.2), (15.361291334027172, 13.0), (12.085527300579672, 13.0), (32.87822706215914, 44.3), (29.81969536495621, 23.9), (12.306630771951422, 15.0), (14.312223424685115, 14.0), (24.59684968702412, 19.0), (20.98028686144879, 13.0), (23.914112401864756, 24.0), (31.80716559499377, 41.5), (30.798976580970088, 29.0), (21.500265556782978, 18.0), (35.81296576009598, 38.0), (13.56087991982394, 15.0), (29.067534158502095, 25.8), (22.331776370351044, 20.0), (27.573691518750124, 24.2), (26.052357081756476, 27.0), (16.868794017918468, 15.5), (26.772473851657594, 27.4), (23.685871542243596, 26.6), (16.41404011314552, 17.0), (15.032101925530673, 16.0), (11.229430034068269, 13.0), (31.483169640537316, 34.3), (21.298875919012662, 19.2), (22.578335056467974, 15.0), (12.424866634056372, 14.0), (27.0610291347415, 27.0), (12.071186365057265, 14.0), (35.83193217840089, 31.0), (23.23456277077468, 26.0), (16.528612701226756, 16.0), (30.53691561311805, 34.0), (22.49635660904369, 20.0), (32.46809382367217, 32.4), (27.933211016247316, 28.0), (16.95170739261925, 16.0), (25.336207345139687, 30.0), (26.67464617489637, 29.0), (17.436743068068154, 17.5), (22.986004289987566, 23.0), (24.930500381138305, 25.5), (14.967950468347066, 17.0), (21.18891614319478, 19.2), (16.739432437377275, 16.9), (25.30456198944367, 30.0), (20.41216813270402, 17.6), (16.172685268053172, 15.5), (25.56417905009375, 27.2), (32.01965331011037, 33.5), (21.80399493977054, 20.5), (32.63905078847845, 38.0), (20.520744647783676, 18.0), (12.975045470120637, 14.0), (9.376053408318434, 12.0), (20.833241669497426, 15.0), (23.19129305605224, 22.0), (26.475132490173202, 28.1), (30.113777676291143, 26.0), (20.744681026859197, 17.5), (19.757909472787965, 19.0), (31.30227482847821, 34.7), (30.052046372650885, 34.5), (23.49252178916847, 21.5), (21.27362768932686, 18.0), (19.932250361597717, 15.0), (30.499256949386954, 27.2), (8.82530938262942, 13.0), (32.53054897497456, 32.2), (25.92344085111094, 24.0), (14.203004117735023, 15.0), (17.451546891081936, 18.0), (30.641104386749532, 32.9)]
sse:     10.8820
TEST
[(29.15567616992968, 30.5), (24.1398018586925, 25.0), (20.67269311902146, 21.0), (27.986346556437812, 24.5), (13.680558882177872, 16.0), (20.89211563950849, 25.0), (33.2269753444567, 31.8), (31.74772800738323, 36.0), (25.270853650006913, 19.8), (18.865722817052237, 20.0), (20.263629210852017, 18.0), (22.353129980934252, 19.0), (25.796864783881748, 23.0), (29.470345864173346, 21.1), (16.43016102494854, 17.0), (20.41677646697586, 20.2), (26.81954793347256, 26.0), (19.738358892298777, 18.0), (28.737622397995853, 29.0), (33.92942134214265, 37.2), (17.793450083090207, 15.0), (23.428593618419193, 25.4), (28.40148208536985, 30.0), (22.938432576328314, 24.0), (30.024660945562253, 28.0), (23.911999732656263, 19.1), (28.326115162550227, 27.0), (16.615720641172096, 13.0), (25.626363628684732, 22.3), (25.754532980840406, 28.0), (29.437308680219775, 28.0), (25.986176464141597, 28.0), (17.669274193752422, 17.0), (8.947093188956476, 12.0), (15.102872003110937, 18.0), (19.945418086663935, 18.0), (27.51238691504597, 27.0), (33.42684479593799, 34.1), (31.85709805130295, 29.5), (27.691200814929687, 27.0), (26.70118524207272, 24.0), (27.337884993573258, 25.5), (30.291368917716024, 30.0), (10.007252375734652, 14.0), (23.57241933122762, 28.0), (22.752940445784006, 18.1), (36.375498563328286, 35.1), (10.856948712942412, 13.0), (18.111945478827206, 15.0), (11.910196011201425, 16.0), (32.01086492410332, 39.4), (26.53512020752116, 26.4), (25.72251529160355, 26.8), (34.39055985631744, 36.0), (27.490468056289046, 18.0), (31.744264470260475, 31.5), (11.925897260499895, 14.0), (19.50345818499808, 18.0), (10.494378341535079, 14.0), (24.639840915349183, 23.0), (15.366038922977424, 15.0), (25.14259288831062, 26.0), (36.434880158051755, 39.1), (31.678712607528833, 32.0), (5.732247949037839, 9.0), (15.640399482507785, 15.5), (17.223123820953443, 13.0), (24.72628713082283, 21.0), (25.4261681839247, 26.0), (25.750876466163405, 26.5), (21.068673831155326, 18.5), (29.212437840581202, 28.0), (33.9098047730359, 29.8), (32.01491462306707, 43.1), (31.50932700517177, 36.1), (24.491236595569887, 26.0), (24.82021505647324, 23.0), (29.205941549683175, 30.0), (21.085363830663955, 20.5), (10.025017915901557, 11.0), (21.31082214620344, 18.0), (25.27344856130826, 25.0), (30.97659270031793, 32.0), (20.37253452498951, 18.6), (17.967601585592668, 16.0), (24.586561207659525, 25.0), (26.210566422096555, 21.5), (7.855484936951811, 10.0), (17.961607977723077, 19.0), (22.77915354852392, 22.0), (30.868827506767644, 32.1), (11.791629001357487, 14.0), (21.03707947940747, 16.2), (29.159307815803235, 27.5), (33.37877037935047, 46.6), (6.136350475599766, 13.0), (29.26138428931467, 30.5), (27.215872004399124, 28.4), (26.832526879374278, 27.9), (17.027731898431746, 16.0), (9.22428310413015, 11.0), (26.681255185957752, 28.0), (33.39466413634653, 40.8), (35.65180092294876, 38.0), (15.723069960652484, 14.0), (24.05104885112962, 20.2), (32.446005573636256, 33.0), (28.280969735945867, 26.0), (29.686872358655343, 27.2), (27.178235573339183, 23.5), (22.300164196653256, 18.0), (29.330120293307015, 29.0), (23.155923509933288, 22.0), (28.603706459509514, 33.5), (20.26444676952112, 20.0), (12.231556587462002, 16.0), (35.036703911996106, 37.0), (20.43723714581529, 20.0)]
sse:     10.8654

TRAIN
[(32.84645611205804, 39.4), (20.33464904413851, 20.0), (9.078161324324357, 12.0), (21.18579485860656, 19.0), (19.33086536271343, 18.0), (32.65836889009757, 32.2), (16.801061908140667, 11.0), (30.862841196948192, 32.9), (32.272479269473834, 43.4), (25.934392937322407, 26.0), (22.86490249856113, 24.0), (17.20197494317585, 19.0), (32.1603771976703, 29.5), (32.237691662108745, 31.0), (19.366418265039933, 19.0), (29.874691273446157, 30.0), (10.164494903312058, 11.0), (25.942651189688362, 21.5), (26.236143884264827, 30.7), (24.44258620890279, 20.2), (12.556576110910996, 14.0), (12.748300644191625, 14.0), (16.716500727022158, 13.0), (25.366758321128664, 22.3), (23.028474723564912, 23.0), (31.100203575154488, 32.0), (24.6390636621653, 19.0), (29.125412561987837, 29.0), (24.378927492924817, 23.0), (35.235775478124864, 44.6), (28.3209857496245, 30.9), (20.97890547816903, 20.5), (14.65814436566679, 15.0), (26.55900711801504, 23.0), (20.37536377858924, 18.0), (25.820491728187726, 30.0), (23.778375928672872, 24.0), (11.81741470283406, 14.0), (22.163624260905568, 18.1), (20.37724808788182, 21.0), (19.611263901477272, 18.0), (28.01104298741695, 31.0), (34.84328514098925, 34.0), (23.370348156571797, 18.1), (28.403640418381805, 27.0), (31.779607473244997, 34.3), (12.848167760096043, 15.0), (26.53741733618381, 28.8), (25.97511233862292, 22.0), (22.49811871913263, 24.0), (20.99545355579179, 19.2), (20.51248467487153, 18.6), (37.24751525817062, 39.1), (20.495511882379922, 18.2), (27.518569922377395, 20.0), (10.635681734410445, 14.0), (16.82333833116766, 16.0), (25.694149640062772, 26.0), (16.463291986609896, 17.0), (19.823383432124, 16.5), (30.83151490975168, 36.0), (25.824520584661514, 21.5), (17.319563993723193, 17.5), (21.668599642494097, 20.5), (11.010863851377879, 14.0), (15.73205122487907, 15.0), (29.15110564705501, 31.0), (36.389136858979555, 32.0), (31.663823388810464, 32.0), (26.278867767178486, 24.0), (11.64720383845453, 13.0), (28.650876426091955, 25.4), (27.075170860445155, 24.0), (8.566606284248694, 10.0), (34.20189818998359, 29.8), (34.19748571841924, 31.8), (26.075131737819948, 26.8), (24.925685886433588, 30.0), (16.321541532343932, 15.5), (30.508018382532796, 31.0), (15.218505442769965, 14.5), (24.638017886789275, 26.5), (27.548929350909127, 27.0), (7.722984278997291, 10.0), (33.80604494526048, 44.3), (10.636766652085267, 15.0), (30.30174247289696, 29.0), (35.21956856442263, 37.7), (31.268909475254425, 34.0), (14.122921576450606, 17.5), (31.483180062526547, 32.0), (18.396775283503864, 13.0), (30.95692172962302, 34.7), (26.89263593515864, 36.4), (19.976536056775018, 19.4), (29.69947723108207, 27.2), (30.581198059704505, 29.5), (35.93908031636679, 44.0), (15.293901178910401, 16.0), (23.13248780933691, 22.0), (8.514773178831751, 12.0), (20.133659935973025, 18.5), (22.83187222075613, 20.0), (8.37012406058849, 12.0), (31.573562228657657, 36.1), (21.13180562031267, 18.5), (13.343808606123414, 15.0), (34.28533905202789, 40.8), (32.859033299974364, 32.4), (10.439760334280864, 12.0), (32.4816577864879, 30.0), (16.89089273104729, 18.0), (10.882621284526518, 13.0), (25.7631691885451, 26.0), (31.273120197905673, 31.3), (27.493831383889486, 32.7), (23.596407036878922, 19.4), (11.783654109814071, 13.0), (28.853238609022842, 24.5), (29.74452496605299, 28.0), (26.531280730483118, 26.4), (5.714332329821066, 12.0), (29.985437731812834, 29.0), (23.934371204541247, 28.0), (24.390431937263948, 21.0), (22.543835139767687, 15.0), (11.642720652135722, 14.0), (34.372367326959576, 37.2), (32.93864717259164, 43.1), (31.543864195105485, 37.0), (22.411627868860208, 18.0), (25.468220869971983, 25.1), (28.867809491404874, 25.8), (9.542615240234436, 13.0), (20.849023856087488, 18.0), (27.42314735097207, 25.0), (19.403089104228663, 18.0), (22.896158618745936, 17.5), (15.775297255562347, 13.0), (29.056523930789805, 34.2), (18.070504230048012, 15.0), (29.208391924563088, 26.0), (20.22394392375697, 20.0), (28.81166597297264, 29.0), (19.93418599895521, 18.0), (14.22947199791801, 15.0), (21.556266781398005, 19.0), (25.444381205842962, 26.0), (22.84804768362348, 21.0), (25.003608355473563, 19.0), (29.961576203860318, 28.0), (34.573667432364815, 36.0), (29.297253646106174, 31.0), (29.085628805299866, 27.5), (24.471466867660993, 25.5), (35.42333419682018, 38.1), (31.480064996026393, 35.7), (23.79379667921284, 22.0), (28.059007247790294, 27.0), (28.198584761536857, 27.0), (29.865612288946753, 34.5), (29.591327871741292, 21.1), (12.795965735641845, 16.0), (27.095209250357147, 26.0), (26.856073144183114, 29.0), (27.965944392903754, 28.0), (25.34022223648914, 24.0), (37.0677042611134, 35.1), (15.467347446844693, 16.0), (23.26920485195029, 20.0), (24.052046660521786, 22.4), (23.50177490828007, 20.5), (22.01366163699431, 21.0), (26.429807025351458, 20.2), (25.17313482776249, 23.8), (30.84792729758322, 29.9), (30.670148236600497, 26.0), (13.263184540215438, 15.0), (36.26730781501845, 38.0), (27.794868001279333, 24.0), (26.016854654790105, 27.0), (16.031589434597084, 15.5), (24.089803917597372, 20.0), (25.573058351940876, 20.3), (24.0592473964037, 23.0), (32.46751344320433, 34.4), (23.073746869121912, 22.5), (32.46522235389088, 36.0), (18.274584557975356, 18.0), (22.910694439005844, 22.0), (18.10767067725564, 15.0), (26.161176549627864, 28.0), (7.972483753384011, 11.0), (27.577767448549775, 26.0), (21.103973972994044, 19.0), (10.936291634581316, 14.0), (26.470136453414693, 26.0), (24.78925654004361, 23.0), (12.711183291904474, 14.0), (32.60967800212648, 33.5), (32.38315541926039, 33.0), (16.97021638708958, 16.9), (19.740735001340745, 15.0), (32.447639772424935, 31.9), (27.09853591869065, 28.4), (23.92142632389585, 25.0), (36.505736163247924, 37.0), (22.3941976325641, 23.0), (20.885669334074777, 23.0), (26.21153531104759, 24.3), (29.44066734951709, 27.0), (20.500321551661234, 25.0), (24.615033068426303, 26.6), (29.49040349352761, 27.0), (30.93326801332457, 27.2), (26.386411345179354, 28.1), (30.312649030521754, 28.0), (25.04477891820938, 28.0), (8.44301768472015, 11.0), (16.09920798554972, 15.5), (24.9210345047376, 25.0), (10.43505680236042, 13.0), (14.875158386282202, 17.0), (31.8922251235335, 41.5), (19.295444912649213, 15.5), (29.359050505730124, 30.5), (16.795356397076816, 16.5), (23.985737469790635, 23.9), (16.786713955819504, 18.0), (33.16922466375497, 32.4), (20.567072980652547, 17.5), (27.630727257305193, 25.5), (31.02799567907012, 29.0), (15.4243384993465, 15.0), (30.17720391412194, 23.7), (24.73710029648527, 19.0), (23.135472514810225, 26.0), (31.327638778961973, 31.5), (20.137452351696073, 17.0), (33.58826611068838, 39.0), (20.697502561812318, 15.0), (28.920286891283904, 30.5), (30.375878086078007, 35.0), (29.094183602620745, 38.0), (12.200677477499374, 14.0), (18.900929642696404, 22.0), (15.687338296773909, 14.0), (25.852189753201507, 30.0), (21.456017832580997, 19.2), (19.63456962595129, 16.0), (28.93110676937875, 33.5), (35.489181323149104, 34.1), (26.25971770454159, 24.0), (23.035457848162245, 17.0), (9.738443967201317, 14.0), (23.70725847982745, 21.5), (21.931375495362563, 22.0), (29.798634041447137, 29.8), (21.22785732821002, 23.0), (25.88630284655388, 21.6), (16.798511566914485, 18.0), (36.22167845131302, 38.0), (27.419432106937123, 23.5), (21.606829070684203, 20.0), (20.50964844805234, 17.6), (16.159342482307828, 16.0), (11.35225651529971, 14.0), (29.22170740388913, 30.0), (32.44558295766449, 38.0), (29.98559458923997, 26.0), (35.27259835758561, 36.0), (26.868523157946544, 26.0), (29.091761132872215, 26.6), (23.479641343452634, 28.0)]
sse:     11.0201
TEST
[(20.63730157431211, 22.0), (22.927516633003393, 20.0), (27.592609374418192, 27.0), (29.58568476473027, 29.0), (28.189208542913406, 26.0), (12.089847820466266, 13.0), (26.393564368229928, 22.0), (6.455396910104081, 9.0), (26.110512480966197, 27.4), (21.661068420827227, 24.0), (18.385228819942192, 20.0), (26.72502641865283, 24.0), (16.280403211698992, 13.0), (21.41205158381513, 14.0), (31.011381816308287, 37.3), (24.016386996803515, 25.0), (11.008459349280049, 14.0), (23.91987761048945, 23.0), (22.914788362248014, 20.6), (10.078239807083973, 13.0), (14.767590813578115, 18.0), (23.81284220287239, 20.8), (33.99883212199976, 46.6), (30.17091184888751, 32.0), (29.72751112858357, 35.0), (33.62723107583315, 34.1), (11.297514509800653, 13.0), (4.7542455689027685, 13.0), (33.524989521988196, 32.8), (17.518682555183666, 17.5), (27.302941336372363, 24.0), (21.327069595316186, 18.0), (15.373352241950842, 18.0), (29.006010117864513, 25.0), (22.04174433465704, 19.9), (21.39535476559605, 18.0), (27.34618261874304, 33.5), (22.755019299072366, 25.0), (15.511312642985173, 16.0), (25.627707404482095, 19.8), (31.526792402427205, 31.6), (17.807809184384716, 16.0), (13.359822323718488, 14.0), (21.890099750769117, 20.6), (25.204674744298405, 27.0), (26.625409740628253, 27.9), (13.259883692878159, 16.0), (11.724490225521889, 16.0), (28.338192478652793, 30.0), (10.184514918926984, 12.0), (31.7052173670961, 32.0), (17.26033862266253, 19.0), (25.99391442118408, 23.2), (18.70103867626774, 18.5), (29.2760094321398, 29.0), (11.970174724141998, 15.0), (27.09922099607553, 18.0), (32.906086169865205, 36.0), (23.658651830429612, 17.6), (32.527053827727975, 31.5), (14.406844009437128, 15.0), (25.510252065510983, 25.0), (29.385395145916036, 31.0), (24.031975017316043, 19.1), (30.891359380264518, 32.1), (20.815563558323525, 20.2), (26.494067907080193, 28.0), (16.25561905637917, 15.5), (21.400119547706215, 16.2), (22.160194123139622, 19.2), (36.23185408717747, 37.0), (11.003055014499324, 14.0), (36.80484440445434, 31.0), (10.804786240569497, 14.0), (35.4214483976695, 32.3), (13.738330243190319, 16.5), (10.075129820268986, 14.0), (21.19910288357729, 22.0), (20.287607533195676, 21.0), (21.400740621274494, 13.0), (24.706406946961238, 25.0), (35.14857960214572, 36.0), (34.62588205196221, 36.1), (20.27387874976032, 19.0), (24.9327972901889, 21.0), (19.686960079151028, 18.0), (17.001692336401273, 17.0), (30.136065599627628, 23.9), (33.271063262691655, 33.0), (24.907975087972027, 24.5), (14.743138581501766, 17.0), (7.918096625080991, 13.0), (29.296283179057916, 22.0), (17.290318142345082, 13.0), (16.473445674345502, 17.0), (28.163457954517988, 24.2), (11.4858243045022, 13.0), (14.622310673014432, 13.0), (13.816255805672078, 14.0), (16.403875096882064, 16.0), (13.76346490417471, 13.0), (20.87790872025019, 17.7), (34.013267900392826, 33.8), (27.565993913042696, 25.0), (32.482805981866605, 33.0), (26.123808627869874, 27.2), (24.19546763289452, 26.0), (21.03516380721135, 21.0), (13.865791803825452, 15.0), (11.67495281867987, 16.0), (22.5616498914528, 19.0), (25.550004946113265, 28.0), (22.992808221126634, 25.4), (14.656637198569237, 16.0), (33.69732452682408, 33.7), (9.807213821454663, 13.0), (21.85953952378381, 19.0), (24.205169224830787, 20.2)]
sse:     11.1495

TRAIN
[(8.962027456324803, 13.0), (16.397153176845716, 15.5), (15.086641622844333, 16.0), (22.874950501986607, 23.0), (28.205847318439627, 31.0), (29.031498611216595, 27.5), (14.795863209271937, 16.0), (19.656138842843617, 18.2), (20.605892837427522, 23.0), (26.631601981862367, 28.4), (19.597912683117013, 15.0), (31.65011712738173, 31.5), (21.032277875496856, 22.0), (35.33146816854954, 32.0), (19.903144760688278, 17.6), (29.064870394504197, 29.0), (27.561998321623214, 18.0), (15.472991557442372, 13.0), (31.35970673797586, 32.0), (9.294573860008445, 12.0), (32.47599520927234, 33.0), (30.018709293220944, 32.1), (26.41768860631654, 24.0), (11.507470097395235, 14.0), (16.24487444117291, 11.0), (25.886380043817987, 24.0), (9.420898737590631, 12.0), (24.433925516845576, 23.0), (34.50700811546919, 34.1), (32.398276591790854, 44.3), (19.357625910149068, 18.0), (35.95705685928747, 39.1), (10.553367432262561, 13.0), (34.219956069440464, 38.1), (23.46448115241429, 22.4), (25.028527243212753, 26.0), (31.00987166317678, 31.6), (24.768994202790157, 24.5), (15.309166412373436, 15.0), (28.386913302494005, 25.0), (23.89431375834868, 20.2), (30.865779906792486, 32.0), (30.674415571736454, 31.5), (30.22701463427594, 29.5), (33.932832801982656, 34.0), (25.39189384779464, 30.0), (18.523752098570306, 20.0), (17.989940031743533, 15.0), (23.89369463515326, 22.0), (12.588417887888976, 16.0), (10.93189565990961, 12.0), (25.689044179441826, 21.6), (32.60021619041279, 32.8), (20.97799081804553, 18.0), (25.507441068689932, 20.2), (27.189322518815842, 25.0), (31.827422537107388, 30.0), (17.634222830356716, 15.0), (35.866482883247336, 35.1), (29.602059013508352, 32.0), (31.6071370318321, 43.1), (29.260324081173195, 26.0), (13.579576664038171, 14.0), (22.005325261344407, 15.0), (25.330243109291395, 25.1), (14.065807767749885, 15.0), (23.878000864147086, 28.0), (26.357239242316222, 22.0), (19.28405884697077, 16.5), (22.019327291642377, 19.0), (14.68039136107225, 13.0), (21.08969270805173, 19.9), (25.84805897161632, 23.0), (16.487087537780265, 16.0), (27.289662985450803, 24.0), (16.737851560154528, 16.0), (22.768213476332754, 25.0), (23.339985135573855, 19.1), (27.065924756464074, 27.0), (11.636894610749598, 13.0), (27.796170090033865, 38.0), (13.640638738696515, 13.0), (12.156749740791145, 14.0), (24.417468153010958, 25.5), (26.57002920081034, 26.0), (10.707643023293919, 14.0), (18.626835433902407, 18.0), (19.268743817765866, 18.0), (20.864351748760868, 19.0), (31.08451098906406, 37.0), (26.484102955289192, 23.5), (34.31394329040688, 36.0), (20.550868079414162, 13.0), (34.29184592499264, 32.3), (23.060249197341772, 21.5), (27.703127116948224, 31.0), (19.62371067838619, 18.0), (24.22591434150855, 23.0), (23.349853027506605, 17.6), (25.766562441395937, 25.0), (19.361974304583285, 16.0), (24.20992314955244, 24.0), (30.604040424554675, 32.0), (23.932506762597303, 25.0), (16.080339281599635, 16.0), (21.01891092286954, 18.0), (29.647767430803796, 29.8), (26.51451961976582, 21.5), (27.89625294628637, 26.0), (33.13344177953208, 33.7), (27.306462335036638, 27.0), (28.142755463607607, 25.4), (22.237802075401284, 21.0), (28.386439210549984, 26.0), (31.924279188590027, 39.4), (22.35468230359739, 20.6), (22.606110641059313, 20.0), (17.273500895098376, 17.5), (28.68264625905773, 31.0), (31.205241359933943, 41.5), (12.625361684695688, 13.0), (30.340513238376463, 29.0), (20.083042594729836, 18.0), (13.565488438995338, 16.0), (21.568445952266142, 21.0), (29.787674484402523, 23.9), (30.174615587632296, 36.0), (26.038400172543682, 26.4), (25.848631838892356, 26.0), (24.41633510359873, 21.0), (20.166354411937522, 23.0), (12.496768615057253, 14.0), (24.31142071953571, 25.0), (20.71600216256569, 18.5), (30.984055959641108, 34.3), (25.73517067354446, 30.0), (11.004856015105098, 15.0), (14.650424809117135, 15.0), (20.17308471072249, 19.2), (23.36345592703553, 26.0), (17.658690798569832, 19.0), (10.839611738127278, 13.0), (33.92432086231096, 36.0), (26.29188307594771, 25.0), (19.373771688409896, 19.0), (25.08441286634148, 30.0), (12.353368727221582, 15.0), (15.80541673288728, 15.5), (27.08358103735907, 32.7), (22.22816202732575, 24.0), (23.2956233295445, 20.8), (13.248167082124134, 15.0), (24.045547685029735, 21.0), (31.85320056303293, 33.5), (10.802873970747944, 12.0), (31.773033156228486, 33.0), (35.17285501154239, 37.0), (27.763463222867752, 27.0), (28.54978299443901, 30.5), (22.893474869489502, 24.0), (32.23855117900544, 39.0), (26.026460749340085, 27.4), (25.398203798884794, 28.0), (29.384255842000396, 21.1), (31.731269547713502, 33.0), (22.891820107725245, 22.0), (16.96282159964803, 13.0), (20.68348627316464, 21.0), (26.20713466191473, 28.1), (12.43620477534629, 13.0), (26.01955490727256, 21.5), (10.511180078350147, 14.0), (22.25028930447256, 17.5), (23.47925244971341, 20.2), (25.244073589312542, 20.3), (28.022956502671235, 27.0), (17.359168344950795, 17.0), (14.900683411898747, 17.0), (21.978387244549094, 19.0), (27.340800729029542, 28.0), (26.57901925626398, 24.0), (18.883157860568925, 22.0), (35.47391011408026, 31.0), (16.688447799835597, 16.0), (9.504316617529804, 12.0), (25.08231996674214, 28.0), (12.781364614539019, 14.0), (27.10375353150018, 33.5), (26.939076100987737, 24.0), (11.983761844615476, 14.0), (28.70087939168289, 34.2), (13.809061548895812, 16.5), (27.861821951279232, 22.0), (10.273120891678957, 13.0), (21.34533062090439, 20.5), (30.09037763042574, 26.0), (27.74528702792434, 30.0), (22.783742778508543, 20.5), (28.386398647212815, 26.6), (29.55778444256835, 29.0), (18.822520728766584, 18.5), (25.48974169939257, 27.0), (25.56477209739564, 27.2), (8.698048646122045, 11.0), (33.88860834283837, 36.0), (28.162270464577304, 29.0), (16.478771706924533, 17.0), (30.61914205326035, 36.1), (20.042798927020627, 20.2), (29.610514350990776, 35.0), (23.09706368307562, 26.6), (20.424134079733154, 18.0), (27.62660862555593, 24.5), (20.61703178133946, 22.0), (15.955034138204603, 15.5), (32.18210181069079, 32.4), (22.831338480542662, 20.0), (30.41568307621844, 23.7), (26.904180721146428, 26.0), (33.07369317072452, 31.8), (11.770196838393886, 14.0), (11.105191912338945, 14.0), (12.98413708997273, 14.0), (28.482505298793065, 30.0), (24.414452687813572, 19.0), (31.341333305484035, 34.4), (18.703113343888173, 15.5), (23.113830915265524, 25.4), (19.42264349001819, 18.5), (27.08992052643791, 24.0), (21.030399468960667, 25.0), (26.925257819914986, 25.5), (24.832317775976904, 23.0), (30.51232035624941, 32.9), (22.258834757324248, 20.0), (20.372019038857047, 17.5), (15.96167270747737, 15.5), (23.47335955499089, 20.0), (22.301518899414848, 23.9), (20.792368483741487, 18.0), (20.11550861253991, 21.0), (31.547495831952478, 38.0), (10.705746367458456, 14.0), (26.29872947654976, 24.0), (25.56716073046841, 24.3), (29.453914874928945, 29.0), (13.357629940996578, 15.0), (10.71401251007691, 13.0), (21.606405604393338, 20.6), (24.91668844898862, 23.8), (22.27310279487392, 18.1), (23.45583886056287, 20.0), (35.18410920254392, 38.0), (25.562327975373886, 26.0), (27.57531565888296, 24.2), (21.293200771046603, 19.0), (31.58902303806896, 29.5), (16.282924629291095, 13.0), (27.86760986537804, 30.9), (31.62252710491, 31.0), (28.77340009222547, 28.0), (13.559865746572825, 15.0), (21.737281303085016, 18.1), (25.11686313165191, 22.3), (19.318155488851097, 19.4), (11.09755801054709, 14.0), (25.444758627459517, 23.2), (19.397156689785913, 17.0), (34.22969590004908, 37.7), (19.462190166471032, 14.0), (33.09147629667498, 46.6), (25.780359290697817, 22.0), (6.78709559523104, 9.0), (11.84685180338412, 14.0)]
sse:     10.5092
TEST
[(14.88708123607481, 15.0), (29.92122715487039, 28.0), (32.472606770512115, 32.4), (15.254155267501591, 18.0), (17.178432289127784, 18.0), (24.78266492105845, 25.0), (14.119638003502125, 15.0), (23.028560765216543, 19.4), (28.309013817870397, 25.8), (35.26316954096232, 38.0), (24.906580015385014, 26.5), (24.677746398016488, 19.8), (28.799997276089545, 28.0), (25.359659034546645, 26.0), (26.542447164478002, 29.0), (7.098576589945261, 12.0), (6.334759728194857, 13.0), (15.263470016056413, 14.5), (20.36023367001566, 15.0), (28.539919900692876, 27.0), (33.54009131802508, 37.2), (28.297416949922713, 29.0), (30.528377582449103, 32.0), (9.146523974705293, 11.0), (12.891597133578045, 14.0), (23.311852443205076, 28.0), (29.99029484343017, 34.0), (23.929032383369197, 23.0), (14.175239015656901, 14.0), (19.682469969228357, 18.0), (26.20246069923461, 27.0), (30.81689313196998, 31.3), (20.072848151283534, 20.0), (27.380792603996344, 27.0), (29.5901245947743, 29.9), (25.200141744487475, 26.8), (22.459415969377254, 22.5), (15.443065337653367, 15.0), (17.617675407621107, 19.0), (32.15951710522271, 32.2), (21.223460767940175, 16.2), (30.436484892223245, 35.7), (16.449907936172448, 13.0), (28.08055308029158, 33.5), (20.706797469336475, 20.5), (23.128133755232636, 23.0), (8.026295956546837, 10.0), (31.587081718606072, 36.0), (26.951381660352922, 26.0), (29.354067790993838, 30.0), (28.6669546178796, 30.5), (21.90036859004558, 18.0), (33.07559095208963, 33.8), (22.627325576819885, 22.0), (24.14696164367474, 25.0), (30.513453334217218, 37.3), (17.11128767288222, 17.5), (20.847127886052608, 21.0), (30.958884694450177, 43.4), (31.331381159256427, 36.0), (26.286190067458662, 27.9), (29.805740850460978, 31.0), (22.37820671224463, 24.0), (28.940759351354977, 27.2), (33.91380153207251, 44.0), (26.085082174508713, 28.0), (32.99796638326648, 34.1), (12.215756424771786, 16.0), (11.795211080578184, 13.0), (14.470542447462206, 17.5), (17.73751632720293, 13.0), (17.261191781077258, 18.0), (12.274092341692983, 16.0), (33.19798107057706, 40.8), (27.092780928187246, 20.0), (19.73855760149371, 20.0), (26.42074700890441, 28.0), (29.19365365391269, 34.5), (20.22666586795673, 19.0), (34.81286061399969, 37.0), (15.613402411740786, 14.0), (28.825551549129965, 29.0), (10.516237199786492, 11.0), (22.856096654096962, 17.0), (8.762434978563034, 10.0), (29.28175694425988, 35.0), (21.65940056421602, 19.0), (24.061404496551155, 26.0), (22.89634550659126, 22.0), (28.66855588198958, 31.0), (24.50393722360583, 19.0), (30.454663540793923, 27.2), (11.33485650529261, 13.0), (30.26585962571729, 34.7), (14.88843000897883, 18.0), (31.724300067054003, 31.9), (16.17447112956021, 17.0), (26.440838687062257, 36.4), (25.43067992635893, 19.0), (25.585090295771057, 30.7), (20.146947119880682, 18.6), (28.446996307581138, 27.0), (11.673531013609885, 14.0), (21.02936463914122, 19.2), (20.332295246467126, 17.7), (34.47253236302007, 44.6), (33.69942713552898, 36.1), (16.607411199648027, 16.9), (12.115688094999484, 13.0), (17.440124945782493, 16.5), (17.113012015296075, 18.0), (25.730533545704432, 28.8), (14.897500648277017, 17.0), (15.388230592386961, 16.0), (17.82038765057498, 16.0), (26.40759463071174, 26.0), (20.92473267888269, 19.2), (33.179154084646285, 29.8)]
sse:     12.0235


on train
on test
on train with dataprep
on test with dataprep

sse:      9.3870
sse:     12.9443
sse:      6.7860
sse:      9.5315

sse:      8.2096
sse:     13.4354
sse:      5.8286
sse:     10.4128

sse:     10.8320
sse:     11.4525
sse:      8.7123
sse:      8.3959

sse:     11.0980
sse:     11.8757
sse:      8.5273
sse:      8.8087

sse:      9.9495
sse:     12.3959
sse:      7.5314
sse:     10.0907

sse:     11.0038
sse:     12.1795
sse:      7.1515
sse:     10.5919

sse:     12.3714
sse:     11.3313
sse:      9.8675
sse:      8.8122

sse:      8.6686
sse:     12.1583
sse:      6.3405
sse:      9.4973

sse:      8.8344
sse:     13.4875
sse:      6.8082
sse:      9.9171

sse:      8.4802
sse:     12.9180
sse:      7.2819
sse:      8.9342


"""
